global
        log 127.0.0.1   local0
        log 127.0.0.1   local1 debug
        maxconn   45000 # Total Max Connections.
        daemon
        nbproc      1 # Number of processing cores.
        nbthread  4
defaults
        timeout server 86400000
        timeout connect 86400000
        timeout client 86400000
        timeout queue   1000s

#---------------------------------------------------------------------
# FrontEnd Configuration Setup 1
#---------------------------------------------------------------------
frontend main
    # cortx_setup_1 data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
    option forwardfor
    default_backend cortx-setup-1

    # cortx_setup_https data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
    option forwardfor
    default_backend cortx-setup-https

    # s3 auth server port - iam
    # auth_port_9080 data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
    acl s3authbackendacl dst_port 9080
    use_backend s3-auth if s3authbackendacl

    # auth_https_port_9443 data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
    acl s3authbackendacl dst_port 9443
    use_backend s3-auth-https if s3authbackendacl
#---------------------------------------------------------------------
# BackEnd roundrobin as balance algorithm Setup 1
#---------------------------------------------------------------------
backend cortx-setup-1
    balance static-rr                                     #Balance algorithm
    # 80 cortx_setup_1 data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE

backend cortx-setup-https
    balance static-rr
    # 443 cortx_setup_https data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
#----------------------------------------------------------------------
# BackEnd roundrobin as balance algorith for s3 auth server
#----------------------------------------------------------------------
backend s3-auth
    balance static-rr                               #Balance algorithm
    default-server inter 2s fastinter 100 rise 1 fall 5 on-error fastinter

    # 9080 s3_auth data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE

backend s3-auth-https
    balance static-rr                               #Balance algorithm

    default-server inter 2s fastinter 100 rise 1 fall 5 on-error fastinter
    # 9443 s3_auth_https data for haproxy.cfg NOTE: PLEASE DO NOT MODIFY THIS LINE
